3
S 0 _ _ -> copy_first 0 ^ _ ^ _ ^
S 1 _ _ -> copy_first 1 ^ _ ^ _ ^
copy_first 0 _ _ -> copy_first _ > 0 > _ ^
copy_first 1 _ _ -> copy_first _ > 1 > _ ^
copy_first | _ _ -> copy_second _ > | > _ ^
copy_first $ _ _ -> mission_complte $ < _ < _ ^
copy_first _ _ _ -> mission_complte $ < _ < _ ^
copy_second 0 _ _ -> copy_second _ > 0 > 0 >
copy_second 1 _ _ -> copy_second _ > 1 > 1 >
copy_second | _ _ -> go_left_compare | ^ _ < _ ^
copy_second $ _ _ -> go_left_compare $ ^ _ < _ ^
copy_second _ _ _ -> go_left_compare $ ^ _ < _ ^
go_left_compare | 0 _ -> go_left_compare | ^ 0 < _ ^ 
go_left_compare $ 0 _ -> go_left_compare $ ^ 0 < _ ^
go_left_compare | 1 _ -> go_left_compare | ^ 1 < _ ^
go_left_compare $ 1 _ -> go_left_compare $ ^ 1 < _ ^
go_left_compare | | _ -> compare | ^ | ^ _ ^
go_left_compare $ | _ -> compare $ ^ | ^ _ ^
compare | | _ -> go_leftD | ^ | ^ _ ^ 
compare $ | _ -> go_leftD $ ^ | ^ _ ^
go_leftD | 0 _ -> go_leftD | ^ 0 < _ ^
go_leftD | 1 _ -> go_leftD | ^ 1 < _ ^
go_leftD | | _ -> takeD | ^ | < _ ^
go_leftD $ 0 _ -> go_leftD $ ^ 0 < _ ^
go_leftD $ 1 _ -> go_leftD $ ^ 1 < _ ^
go_leftD $ | _ -> takeD $ ^ | < _ ^
takeD | Z _ -> takeD | ^ Z < _ ^
takeD | O _ -> takeD | ^ O < _ ^
takeD | 0 _ -> go_right_zeroD | ^ Z > _ ^   
takeD | 1 _ -> go_right_oneD | ^ O > _ ^  
takeD | _ _ -> go_right_checkC | ^ _ > _ ^
takeD $ Z _ -> takeD $ ^ Z < _ ^
takeD $ O _ -> takeD $ ^ O < _ ^
takeD $ 0 _ -> go_right_zeroD $ ^ Z > _ ^   
takeD $ 1 _ -> go_right_oneD $ ^ O > _ ^  
takeD $ _ _ -> go_right_checkC $ ^ _ > _ ^
go_right_zeroD | Z _ -> go_right_zeroD | ^ Z > _ ^
go_right_zeroD | O _ -> go_right_zeroD | ^ O > _ ^
go_right_zeroD | | _ -> zeroD | ^ | > _ ^
go_right_zeroD $ Z _ -> go_right_zeroD $ ^ Z > _ ^
go_right_zeroD $ O _ -> go_right_zeroD $ ^ O > _ ^
go_right_zeroD $ | _ -> zeroD $ ^ | > _ ^
go_right_oneD | Z _ -> go_right_oneD | ^ Z > _ ^
go_right_oneD | O _ -> go_right_oneD | ^ O > _ ^
go_right_oneD | | _ -> oneD | ^ | > _ ^
go_right_oneD $ Z _ -> go_right_oneD $ ^ Z > _ ^
go_right_oneD $ O _ -> go_right_oneD $ ^ O > _ ^
go_right_oneD $ | _ -> oneD $ ^ | > _ ^
zeroD | 0 _ -> zeroD | ^ 0 > _ ^
zeroD | 1 _ -> zeroD | ^ 1 > _ ^
zeroD | Z _ -> zero | ^ Z < _ ^
zeroD | O _ -> zero | ^ O < _ ^
zeroD | _ _ -> zero | ^ _ < _ ^
zeroD $ 0 _ -> zeroD $ ^ 0 > _ ^
zeroD $ 1 _ -> zeroD $ ^ 1 > _ ^
zeroD $ Z _ -> zero $ ^ Z < _ ^
zeroD $ O _ -> zero $ ^ O < _ ^
zeroD $ _ _ -> zero $ ^ _ < _ ^
zero | 0 _ -> go_leftD | ^ Z < _ ^ 
zero | 1 _ -> go_leftD | ^ O < _ ^
zero | | _ -> go_right_clear_start_swap | ^ | > _ ^
zero $ 0 _ -> go_leftD $ ^ Z < _ ^ 
zero $ 1 _ -> go_leftD $ ^ O < _ ^
zero $ | _ -> go_right_clear_start_swap $ ^ | > _ ^
oneD | 0 _ -> oneD | ^ 0 > _ ^
oneD | 1 _ -> oneD | ^ 1 > _ ^
oneD | Z _ -> one | ^ Z < _ ^
oneD | O _ -> one | ^ O < _ ^
oneD | _ _ -> one | ^ _ < _ ^
oneD $ 0 _ -> oneD $ ^ 0 > _ ^
oneD $ 1 _ -> oneD $ ^ 1 > _ ^
oneD $ Z _ -> one $ ^ Z < _ ^
oneD $ O _ -> one $ ^ O < _ ^
oneD $ _ _ -> one $ ^ _ < _ ^
one | 0 _ -> shift | ^ O < _ ^ 
one | 1 _ -> go_leftD | ^ Z < _ ^
one | | _ -> go_right_clear_start_swap | ^ | > _ ^
one $ 0 _ -> shift $ ^ O < _ ^ 
one $ 1 _ -> go_leftD $ ^ Z < _ ^
one $ | _ -> go_right_clear_start_swap $ ^ | > _ ^
shift | 0 _ -> shift | ^ 1 < _ ^
shift | 1 _ -> go_leftD | ^ 0 < _ ^
shift | | _ -> go_right_clear_start_swap | ^ | > _ ^ 
shift $ 0 _ -> shift $ ^ 1 < _ ^
shift $ 1 _ -> go_leftD $ ^ 0 < _ ^
shift $ | _ -> go_right_clear_start_swap $ ^ | > _ ^ 
go_right_clear_start_swap | Z _ -> go_right_clear_start_swap | ^ Z > _ ^
go_right_clear_start_swap | O _ -> go_right_clear_start_swap | ^ O > _ ^
go_right_clear_start_swap | _ _ -> clear_start_swap | ^ _ < _ ^ 
go_right_clear_start_swap $ Z _ -> go_right_clear_start_swap $ ^ Z > _ ^
go_right_clear_start_swap $ O _ -> go_right_clear_start_swap $ ^ O > _ ^
go_right_clear_start_swap $ _ _ -> clear_start_swap $ ^ _ < _ ^ 
clear_start_swap | Z _ -> clear_start_swap | ^ _ < _ ^
clear_start_swap | O _ -> clear_start_swap | ^ _ < _ ^
clear_start_swap | | _ -> start_swap | < _ < _ ^
clear_start_swap $ Z _ -> clear_start_swap $ ^ _ < _ ^
clear_start_swap $ O _ -> clear_start_swap $ ^ _ < _ ^
clear_start_swap $ | _ -> start_swap_last $ < _ < _ ^
start_swap _ 0 _ -> start_swap 0 < _ < _ ^ 
start_swap _ 1 _ -> start_swap 1 < _ < _ ^ 
start_swap _ Z _ -> start_swap 0 < _ < _ ^ 
start_swap _ O _ -> start_swap 1 < _ < _ ^
start_swap _ _ _ -> swap | < _ ^ _ <
start_swap_last _ 0 _ -> start_swap_last 0 < _ < _ ^ 
start_swap_last _ 1 _ -> start_swap_last 1 < _ < _ ^ 
start_swap_last _ Z _ -> start_swap_last 0 < _ < _ ^ 
start_swap_last _ O _ -> start_swap_last 1 < _ < _ ^
start_swap_last _ _ _ -> swap_last $ < _ ^ _ <
swap _ _ 0 -> swap 0 < _ ^ _ < 
swap _ _ 1 -> swap 1 < _ ^ _ < 
swap | _ _ -> next | > _ ^ _ ^
swap _ _ _ -> next _ > _ ^ _ ^
swap_last _ _ 0 -> swap_last 0 < _ ^ _ < 
swap_last _ _ 1 -> swap_last 1 < _ ^ _ < 
swap_last | _ _ -> to_begin | < _ ^ _ ^ 
swap_last _ _ _ -> copy_first _ > _ ^ _ ^
next 0 _ _ -> next 0 > _ ^ _ ^
next 1 _ _ -> next 1 > _ ^ _ ^ 
next | _ _ -> copy_first | > _ ^ _ ^ 
to_begin 0 _ _ -> to_begin 0 < _ ^ _ ^
to_begin 1 _ _ -> to_begin 1 < _ ^ _ ^
to_begin | _ _ -> to_begin | < _ ^ _ ^
to_begin _ _ _ -> copy_first _ > _ ^ _ ^
go_right_checkC | Z _ -> go_right_checkC | ^ Z > _ ^
go_right_checkC | O _ -> go_right_checkC | ^ O > _ ^
go_right_checkC | | _ -> checkC | ^ | > _ ^ 
go_right_checkC $ Z _ -> go_right_checkC $ ^ Z > _ ^
go_right_checkC $ O _ -> go_right_checkC $ ^ O > _ ^
go_right_checkC $ | _ -> checkC $ ^ | > _ ^
checkC | 0 _ -> checkC | ^ 0 > _ ^
checkC | 1 _ -> go_right_clear_start | ^ 1 > _ ^
checkC | Z _ -> checkC | ^ Z > _ ^
checkC | O _ -> go_right_clear_start | ^ O > _ ^
checkC | _ _ -> clear_start_swap | ^ _ < _ ^
checkC $ 0 _ -> checkC $ ^ 0 > _ ^
checkC $ 1 _ -> go_right_clear_start $ ^ 1 > _ ^
checkC $ Z _ -> checkC $ ^ Z > _ ^
checkC $ O _ -> go_right_clear_start $ ^ O > _ ^
checkC $ _ _ -> clear_start_swap $ ^ _ < _ ^
go_right_clear_start | 0 _ -> go_right_clear_start | ^ 0 > _ ^
go_right_clear_start | 1 _ -> go_right_clear_start | ^ 1 > _ ^
go_right_clear_start | Z _ -> go_right_clear_start | ^ Z > _ ^
go_right_clear_start | O _ -> go_right_clear_start | ^ O > _ ^
go_right_clear_start | _ _ -> clear_start | ^ _ < _ ^ 
go_right_clear_start $ 0 _ -> go_right_clear_start $ ^ 0 > _ ^
go_right_clear_start $ 1 _ -> go_right_clear_start $ ^ 1 > _ ^
go_right_clear_start $ Z _ -> go_right_clear_start $ ^ Z > _ ^
go_right_clear_start $ O _ -> go_right_clear_start $ ^ O > _ ^
go_right_clear_start $ _ _ -> clear_start $ ^ _ < _ ^ 
clear_start | 0 _ -> clear_start | ^ _ < _ ^
clear_start | 1 _ -> clear_start | ^ _ < _ ^
clear_start | Z _ -> clear_start | ^ _ < _ ^
clear_start | O _ -> clear_start | ^ _ < _ ^
clear_start | | _ -> start | < _ ^ _ <
clear_start $ 0 _ -> clear_start $ ^ _ < _ ^
clear_start $ 1 _ -> clear_start $ ^ _ < _ ^
clear_start $ Z _ -> clear_start $ ^ _ < _ ^
clear_start $ O _ -> clear_start $ ^ _ < _ ^
clear_start $ | _ -> start_last $ < _ ^ _ <
start _ _ 0 -> start 0 < _ ^ _ < 
start _ _ 1 -> start 1 < _ ^ _ < 
start _ _ _ -> back | < _ < _ ^
start_last _ _ 0 -> start_last 0 < _ ^ _ < 
start_last _ _ 1 -> start_last 1 < _ ^ _ < 
start_last _ _ _ -> back_last $ < _ < _ ^
back _ 0 _ -> back 0 < _ < _ ^ 
back _ 1 _ -> back 1 < _ < _ ^ 
back _ Z _ -> back 0 < _ < _ ^ 
back _ O _ -> back 1 < _ < _ ^ 
back | _ _ -> next | > _ ^ _ ^
back _ _ _ -> next _ > _ ^ _ ^
back_last _ 0 _ -> back_last 0 < _ < _ ^ 
back_last _ 1 _ -> back_last 1 < _ < _ ^ 
back_last _ Z _ -> back_last 0 < _ < _ ^ 
back_last _ O _ -> back_last 1 < _ < _ ^ 
back_last | _ _ -> to_begin | < _ ^ _ ^ 
back_last _ _ _ -> copy_first _ > _ ^ _ ^
mission_complte _ 0 _ -> mission_complte 0 < _ < _ ^
mission_complte _ 1 _ -> mission_complte 1 < _ < _ ^
mission_complte _ _ _ -> complete _ > _ ^ _ ^
complete 0 _ _ -> complete 0 > _ ^ _ ^
complete 1 _ _ -> complete 1 > _ ^ _ ^
complete $ _ _ -> complete | > _ ^ _ ^
complete _ _ _ -> delete_last_char _ < _ ^ _ ^
delete_last_char | _ _ -> answer _ < _ ^ _ ^
answer 0 _ _ -> answer 0 < _ ^ _ ^
answer 1 _ _ -> answer 1 < _ ^ _ ^
answer | _ _ -> answer | < _ ^ _ ^
answer _ _ _ -> AC _ > _ ^ _ ^ 